
<h1 class="w3-center">Abstimmungen</h1>

<div class="myQuestions w3-card-4 w3-dark-grey w3-padding-16 w3-animate-zoom" *ngIf="!resultsVisible">
    <div class="w3-container">
		<span class="w3-tooltip w3-margin">
			<span style="position:absolute;left:0;top:1.8em;width:15em;" class="w3-text w3-tag w3-padding-16 w3-animate-opacity">{{speichernTooltip}}</span> 
			<button class="w3-button w3-hover-green" (click)="toggleSave()" [class.w3-pale-green]="!doSave" [class.w3-green]="doSave"><i class="fa fa-floppy-o" aria-hidden="true"></i> {{speichernText}}</button>
		</span>
        <div class="question-tags w3-right w3-margin">
        	<span class="question-tag" *ngFor="let t of question.topic"><a href="https://wahlbilanz.de/categories/#{{t}}">{{t}}</a></span>
        </div>
	    <div style="clear:both"></div>
        <header class="w3-container w3-light-grey w3-margin">
            <h3>{{question.titel}}</h3>
        </header>
        <div class="question-description w3-margin"> 
            {{question.beschreibung}}    
        </div>
        <div class="w3-light-grey w3-padding w3-padding-16 w3-margin" id="question-{{q}}" *ngFor="let q of actualQuestions">
        	<div class="q-text">
	        	<span class="q-context">{{question.fragen[q].context}}</span>
	        	<strong class="q-question">{{question.fragen[q].frage}}</strong>
	        	<div class="q-supplemental">{{question.fragen[q].subtext}} <a href="{{question.fragen[q].link}}">Mehr Informationen</a></div>
        	</div>
        	<div class="q-buttons w3-right">
		        <button class="w3-button w3-hover-green w3-ripple active w3-large" [class.w3-pale-green]="answers[q]!=1" [class.w3-green]="answers[q]==1" (click)="choose(q,1)"><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> Zustimmen</button>
		        <button class="w3-button w3-hover-red w3-ripple w3-large" [class.w3-pale-red]="answers[q]!=2" [class.w3-red]="answers[q]==2" (click)="choose(q,2)"><i class="fa fa-thumbs-o-down" aria-hidden="true"></i> Ablehnen</button>
		        <button class="w3-button w3-hover-blue w3-ripple w3-large" [class.w3-pale-blue]="answers[q]!=0" [class.w3-blue]="answers[q]==0" (click)="choose(q,0)"><i class="fa fa-hand-peace-o" aria-hidden="true"></i> Enthalten</button>
	        </div>
	        <div style="clear:both"></div>
        </div>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-left w3-ripple w3-large w3-margin-left" (click)="nextQuestion(-1)" *ngIf="questionIndex > 0"><i class="fa fa-chevron-left" aria-hidden="true"></i> vorherige Frage</button>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right" (click)="nextQuestion(1)" *ngIf="questionIndex < questionData.length - 1"><i class="fa fa-chevron-right" aria-hidden="true"></i> nächste Frage</button>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right" (click)="showResults()"><i class="fa fa-line-chart" aria-hidden="true"></i> Auswertung</button>
     </div>
</div>

<div class="w3-light-grey">
  <div class="w3-container w3-green w3-center" [style.width.%]="progress">{{progress | number:'1.1-1'}}%</div>
</div>

<div class="myResult w3-card-4 w3-light-grey w3-padding-16 w3-animate-bottom" *ngIf="resultsVisible">
    <div class="w3-container">
        <header class="w3-container w3-green w3-margin">
            <h3>Auswertung </h3>
        </header>
        <div class="w3-margin">
	        <h4>Welche Partei hat am ähnlichsten wie du abgestimmt?</h4>
	        In der folgenden Tabelle siehst du wieviele Abgeordnete in den verschiedenen Parteien in deinem Sinne abgestimmt haben:
        </div>
        <div class="w3-responsive w3-margin">
	        <table id="auswertungstabelle" class="w3-table w3-bordered w3-hoverable">
	        	<thead class="w3-dark-grey">
	        		<tr>
	        			<th class="w3-left-align">Abstimmung</th>
	        			<th class="w3-center">Deine Antwort</th>
	        			<th class="w3-right-align">Die Grünen</th>
	        			<th class="w3-right-align">CDU</th>
	        			<th class="w3-right-align">DIE LINKE</th>
	        			<th class="w3-right-align">SPD</th>
	        	</thead>
	        	<tbody>
	        		<ng-container *ngFor="let quest of questionData; let i = index">
		        		<tr class="auswertung-abschnitt">
		        			<th class="w3-grey" colspan="6">{{quest.titel}}<button class="w3-button w3-grey w3-left-align" (click)="showQuestion(i)"><small><i class="fa fa-pencil-square-o" aria-hidden="true"></i> ändern</small></button></th>
		        		</tr>
		        		<ng-container *ngFor="let q of quest.fragenIds">
			        		<tr class="auswertung-zeile" id="auswertung-{{q}}">
			        			<td class="w3-left-align">{{quest.fragen[q].short}}</td>
			        			<td class="w3-center" [class.w3-green]="answers[q]==1" [class.w3-red]="answers[q]==2" [class.w3-blue]="answers[q]==0">{{voteOptions[answers[q]]}}</td>
			        			<td class="w3-right-align w3-tooltip">{{quest.fragen[q]['gruenen']}}<span style="position:absolute;z-index:1;right:-30%;top:2.3em" class="w3-text w3-tag"><app-party-votes class="w3-tag" [results]="quest.fragen[q].results['gruenen']"></app-party-votes></span></td>
			        			<td class="w3-right-align w3-tooltip">{{quest.fragen[q]['cdu/csu']}}<span style="position:absolute;z-index:1;right:-30%;top:2.4em" class="w3-text"><app-party-votes class="w3-tag" [results]="quest.fragen[q].results['cdu/csu']"></app-party-votes></span></td>
			        			<td class="w3-right-align w3-tooltip">{{quest.fragen[q]['die.linke']}}<span style="position:absolute;z-index:1;right:-25%;top:2.5em" class="w3-text"><app-party-votes class="w3-tag" [results]="quest.fragen[q].results['die.linke']"></app-party-votes></span></td>
			        			<td class="w3-right-align w3-dropdown-hover">{{quest.fragen[q]['spd']}}<span style="position:absolute;z-index:100;right:0;top:2.6em" class="w3-dropdown-content"><app-party-votes class="w3-tag" [results]="quest.fragen[q].results.spd"></app-party-votes></span></td>
			        		</tr>
		        		</ng-container>
	        		</ng-container>
					<tr class="auswertung-abschnitt">
						<th colspan="6" class="w3-grey w3-left-align">Gesamt</th>
					</tr>
					<tr class="auswertung-zeile">
						<td class="w3-left-align">Gesamtergebnis:</td>
			        	<td class="w3-center"></td>
			        	<td class="w3-right-align">{{overallResult['gruenen']}}</td>
						<td class="w3-right-align">{{overallResult['cdu/csu']}}</td>
						<td class="w3-right-align">{{overallResult['die.linke']}}</td>
						<td class="w3-right-align">{{overallResult['spd']}}</td>
					</tr>
	        	</tbody>
	        </table>
        </div> 
        <div class="w3-margin">
	        Bitte beachte, dass die Auswertung dir nur zeigt welche Parteien so ähnlich abgestimmt haben wie du.
	        <strong>
	        	DeinWal.de kann auf gar keinen Fall die einzige Quelle sein, die du für deine Entscheidung zur Bundestagswahl nutzt!
	        </strong>
        </div>
        <div class="w3-margin">
        	<button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right" (click)="showQuestion(0)"><i class="fa fa-repeat" aria-hidden="true"></i> Fragen nochmal durchgehen</button>
        </div>
        
    </div>
</div>
