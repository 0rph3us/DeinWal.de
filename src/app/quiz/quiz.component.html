
<h1 class="w3-center">Abstimmungen</h1>

<div class="myQuestions w3-card-4 w3-dark-grey w3-padding-16 w3-animate-zoom optional-padding" *ngIf="!resultsVisible">
    <div class="w3-container optional-padding">
		<span class="w3-tooltip w3-margin optional-margin">
			<span style="position:absolute;left:0;top:1.8em;width:15em;" class="w3-text w3-tag w3-padding-16 w3-animate-opacity">{{speichernTooltip}}</span> 
			<button class="w3-button w3-hover-green" (click)="toggleSave()" [class.w3-pale-green]="!doSave && !saveImpossible" [class.w3-green]="doSave && !saveImpossible" [class.w3-dark-grey]="saveImpossible" [class.w3-hover-red]="saveImpossible"><i class="fa fa-floppy-o" aria-hidden="true"></i> {{speichernText}}</button>
		</span>
        <div class="question-tags w3-right w3-margin optional-margin">
        	<span class="question-tag" *ngFor="let t of question.topic"><a href="https://wahlbilanz.de/categories/#{{t}}">{{t}}</a></span>
        </div>
	    <div style="clear:both"></div>
        <header class="w3-container w3-light-grey w3-margin optional-margin">
            <h3>{{question.titel}}</h3>
        </header>
        <div class="question-description w3-margin" [innerHTML]="question.beschreibung">
        </div>
        <div class="w3-light-grey w3-padding w3-padding-16 w3-margin optional-margin" id="question-{{q}}" *ngFor="let q of actualQuestions">
        	<div class="q-text">
	        	<span class="q-context" [innerHTML]="question.fragen[q].context"></span>
	        	<strong class="q-question" [innerHTML]="question.fragen[q].frage"></strong>
	        	<div class="q-supplemental">{{question.fragen[q].subtext}} <a href="{{question.fragen[q].link}}">Mehr Informationen</a></div>
        	</div>
        	<div class="q-buttons w3-right">
		        <button class="w3-button w3-hover-green w3-ripple active w3-large" [class.w3-pale-green]="answers[q]!=1" [class.w3-green]="answers[q]==1" (click)="choose(q,1)"><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> Ja</button>
		        <button class="w3-button w3-hover-red w3-ripple w3-large" [class.w3-pale-red]="answers[q]!=2" [class.w3-red]="answers[q]==2" (click)="choose(q,2)"><i class="fa fa-thumbs-o-down" aria-hidden="true"></i> Nein</button>
		        <button class="w3-button w3-hover-blue w3-ripple w3-large" [class.w3-pale-blue]="answers[q]!=0" [class.w3-blue]="answers[q]==0" (click)="choose(q,0)"><i class="fa fa-hand-peace-o" aria-hidden="true"></i> Enthalten</button>
	        </div>
	        <div style="clear:both"></div>
        </div>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-left w3-ripple w3-large w3-margin-left optional-margin" (click)="nextQuestion(-1)" *ngIf="getQuestionIndex () > 0"><i class="fa fa-chevron-left" aria-hidden="true"></i> vorherige Frage</button>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right optional-margin" (click)="nextQuestion(1)" *ngIf="getQuestionIndex () < questionData.length - 1"><i class="fa fa-chevron-right" aria-hidden="true"></i> nächste Frage</button>
	    <button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right optional-margin" (click)="showResults()"><i class="fa fa-line-chart" aria-hidden="true"></i> Auswertung</button>
     </div>
</div>







<div class="myResult w3-card-4 w3-light-grey w3-padding-16 w3-animate-bottom optional-padding" *ngIf="resultsVisible">
    <div class="w3-container optional-padding">
        <header class="w3-container w3-green w3-margin optional-margin">
            <h3>Auswertung </h3>
        </header>
        <div class="w3-margin">
	        <h4>Welche Partei hat am ähnlichsten wie du abgestimmt?</h4>
	        In der folgenden Tabelle siehst du wieviele Abgeordnete in den verschiedenen Parteien in deinem Sinne abgestimmt haben:
        </div>
        
        
					<div id="tableswitcher">
						<button class="w3-margin">Switch to complex table</button>
						
						
						<div id="complextable" class="w3-responsive w3-margin optional-margin">
							<table id="auswertungstabelle" class="w3-table w3-bordered w3-hoverable">
								<thead class="w3-dark-grey">
									<tr>
										<th class="w3-left-align">Abstimmung</th>
										<th class="w3-center">Deine Antwort</th>
										
										<th class="w3-center" colspan="4">Uebereinstimmung mit den Parteien</th>
								</thead>
								<tbody>
									<ng-container *ngFor="let quest of questionData; let i = index">
										<tr class="auswertung-abschnitt">
											<th class="w3-grey" colspan="2">{{quest.titel}}<button class="w3-button w3-grey w3-left-align" (click)="showQuestion(i)"><small><i class="fa fa-pencil-square-o" aria-hidden="true"></i> ändern</small></button></th>
											
										
											<ng-container *ngFor="let party of partypriority">
												<th class="w3-grey w3-right-align"><img src="/assets/partei-logos/{{getPartyLogo (party)}}" alt="{{getProperPartyName (party)}}" title="{{getProperPartyName (party)}}"></th>
											</ng-container>
										
										</tr>
										<ng-container *ngFor="let q of quest.fragenIds">
											<tr class="auswertung-zeile" id="auswertung-{{q}}">
												<td class="w3-left-align">{{quest.fragen[q].short}}</td>
												<td class="w3-center" [class.w3-green]="answers[q]==1" [class.w3-red]="answers[q]==2" [class.w3-blue]="answers[q]==0">{{voteOptions[answers[q]]}}</td>
												
												<ng-container *ngFor="let party of partypriority">
													<td class="w3-right-align w3-tooltip">{{quest.fragen[q][party]}}<span style="position:absolute;z-index:1;right:-30%;top:2.3em" class="w3-text"><app-party-votes class="w3-tag" [party]="party" [qid]="q" [questions]="quest" [choice]="answers[q]"></app-party-votes></span></td>
												</ng-container>
												
											</tr>
										</ng-container>
									</ng-container>
							<tr class="auswertung-abschnitt">
								<th colspan="2" class="w3-grey w3-left-align">Gesamt</th>
											
										
											<ng-container *ngFor="let party of partypriority">
												<th class="w3-grey w3-right-align"><img src="/assets/partei-logos/{{getPartyLogo (party)}}" alt="{{getProperPartyName (party)}}" title="{{getProperPartyName (party)}}"></th>
											</ng-container>
											
							</tr>
							<tr class="auswertung-zeile">
								<td class="w3-left-align">Gesamtergebnis:</td>
								<td class="w3-center"></td>
								
								<ng-container *ngFor="let party of partypriority">
									<td class="w3-right-align">{{overallResult[party]}}</td>
								</ng-container>
								
							</tr>
								</tbody>
							</table>
						</div>
	        </div>
	        
	        
	        
	        <div id="easytable" class="w3-responsive w3-margin optional-margin">
						<table id="easyauswertungstabelle" class="w3-table w3-bordered w3-hoverable">
							<thead class="w3-dark-grey">
								<tr>
									<th class="w3-center" colspan="2">Deine Auswertung</th>
							</thead>
							<tbody>
								<ng-container *ngFor="let quest of questionData; let i = index">
									<tr class="auswertung-abschnitt">
										<th class="w3-grey">{{quest.titel}}<button class="w3-button w3-grey w3-left-align" (click)="showQuestion(i)"><small><i class="fa fa-pencil-square-o" aria-hidden="true"></i> ändern</small></button></th>
										<td class="w3-grey">Mehrheitlich wie du gestimmt</td>
									</tr>
									<ng-container *ngFor="let q of quest.fragenIds">
										<tr class="auswertung-zeile" id="auswertung-{{q}}" *ngIf="answers[q] >= 0">
											<td class="w3-left-align">{{quest.fragen[q].short}} 
												<button class="w3-button" (click)="toggleSimpleDetails(q)" *ngIf="!simpleDetails[q]"><i class="fa fa-caret-down" aria-hidden="true"></i></button>
												<button class="w3-button" (click)="toggleSimpleDetails(q)" *ngIf="simpleDetails[q]"><i class="fa fa-caret-up" aria-hidden="true"></i></button>
											</td>
											<td class="w3-left-align">
												<ng-container *ngFor="let party of partypriority">
													<ng-container *ngIf="quest.fragen[q].consent.indexOf (party) > -1">
														<img src="/assets/partei-logos/{{getPartyLogo (party)}}" alt="{{getProperPartyName (party)}}" title="{{getProperPartyName (party)}}">
													</ng-container>
												</ng-container>
											</td>
										</tr>
											<tr class="auswertung-detail" id="auswertung-detail-{{q}}" *ngIf="simpleDetails[q]">
												<td class="w3-left-align w3-black" colspan="2">
												Deine Antwort: <span class="w3-center w3-padding" [class.w3-green]="answers[q]==1" [class.w3-red]="answers[q]==2" [class.w3-blue]="answers[q]==0">{{voteOptions[answers[q]]}}</span>
												</td>
											</tr>
									</ng-container>
								</ng-container>
							</tbody>
	        	</table>
	        </div>
        
        
        
        <div class="w3-margin">
	        Bitte beachte, dass die Auswertung dir nur zeigt welche Parteien so ähnlich abgestimmt haben wie du.
	        <strong>
	        	DeinWal.de kann auf gar keinen Fall die einzige Quelle sein, die du für deine Entscheidung zur Bundestagswahl nutzt!
	        </strong>
	        Lies dazu am besten auch den entsprechenden <a [routerLink]="['/faq']" fragment="wenwaehlen">Eintrag in der FAQ.</a>
        </div>
        <div class="w3-margin optional-margin">
        	<button class="w3-button w3-grey w3-hover-light-gray w3-right w3-ripple w3-large w3-margin-right" (click)="showQuestion(0)"><i class="fa fa-repeat" aria-hidden="true"></i> Fragen nochmal durchgehen</button>
        </div>
        
    </div>
</div>



<footer class="w3-bottom">
	<div class="w3-light-grey">
	  <div class="w3-container w3-green w3-center" [style.width]="progress">{{progress}}</div>
	</div>
</footer>
